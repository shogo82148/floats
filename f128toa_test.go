package floats

import (
	"fmt"
	"math"
	"testing"

	"github.com/shogo82148/ints"
)

func TestFloat128_Format(t *testing.T) {
	tests := []struct {
		format string
		x      Float128
		want   string
	}{
		// verb "%b"
		{"%b", exact128(0), "0p-16494"},

		// verb "%f"
		{"%f", exact128(0.5), "0.5"},
		{"%f", exact128(-0.5), "-0.5"},
		{"%+f", exact128(0.5), "+0.5"},
		{"%+f", exact128(-0.5), "-0.5"},
		{"% f", exact128(0.5), " 0.5"},
		{"% f", exact128(-0.5), "-0.5"},
		{"%8f", exact128(0.5), "     0.5"},
		{"%-8f", exact128(0.5), "0.5     "},
		{"%.2f", exact128(0.5), "0.50"},

		// verb "%e"
		{"%.6e", exact128(0.5), "5.000000e-01"},

		// verb "%g"
		{"%g", exact128(0.5), "0.5"},
		{"%.1g", exact128(0.25), "0.2"},

		// verb "%x"
		{"%x", exact128(0.5), "0x1p-01"},
		{"%#x", exact128(0.5), "0x1p-01"},
		{"%.1x", exact128(0.5), "0x1.0p-01"},

		// verb "%X"
		{"%X", exact128(0.5), "0X1P-01"},
		{"%#X", exact128(0.5), "0X1P-01"},
		{"%.1X", exact128(0.5), "0X1.0P-01"},

		// verb "%v"
		{"%v", exact128(0.5), "0.5"},
		{"%v", exact128(math.NaN()), "NaN"},
	}

	for _, tt := range tests {
		got := fmt.Sprintf(tt.format, tt.x)
		if got != tt.want {
			t.Errorf("expected %s, got %s", tt.want, got)
		}
	}
}

func TestFloat128_Text(t *testing.T) {
	tests := []struct {
		x    Float128
		fmt  byte
		prec int
		s    string
	}{
		/****** decimal formats ******/
		{exact128(0x1p-24), 'f', 24, "0.000000059604644775390625"},
		{exact128(0x2p-24), 'f', 24, "0.000000119209289550781250"},
		{exact128(0x3p-24), 'f', 24, "0.000000178813934326171875"},
		{exact128(0x4p-24), 'f', 24, "0.000000238418579101562500"},
		{exact128(0x5p-24), 'f', 24, "0.000000298023223876953125"},
		{exact128(0x6p-24), 'f', 24, "0.000000357627868652343750"},
		{exact128(0x7p-24), 'f', 24, "0.000000417232513427734375"},
		{exact128(0x8p-24), 'f', 24, "0.000000476837158203125000"},
		{exact128(0x9p-24), 'f', 24, "0.000000536441802978515625"},
		{exact128(0xap-24), 'f', 24, "0.000000596046447753906250"},

		{Float128{0, 1}, 'f', 16494, "0." +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000064751751194380251109244389582276465" +
			"52499569338034681009689884389197039540124119371017" +
			"67149127664994025587814147684811967658721988638254" +
			"20466851100719726179830427927107513349344167346256" +
			"38471740239448526505553990391455556252171148068070" +
			"82203468825698247627282878910302835733756134803106" +
			"23865645926398262269919079078676632620657112115830" +
			"64657196068308332845234453069760526489447660964579" +
			"31375140340263180435003994887007525564871336806611" +
			"78794031557667133034674349370624094116852151376073" +
			"33139422843835051668983567167196802642952353504079" +
			"71434710386053778289370021552116866771104295061002" +
			"18815136279864294617004333392019353974988251843353" +
			"85514892844339930852967838448682125502304114122153" +
			"04594646546308476411017447873704433531238966148363" +
			"92105539434114765447862613978750641914512267676146" +
			"25892790369961415069606980007080502788648919975916" +
			"80187822200225238172304723097187657099542882121928" +
			"15965476330235387831371836463969528315305510686834" +
			"19596735374086746290525867996216905323365319885172" +
			"60995682762551103633247835322894763188005068455915" +
			"06083189865215401360612737714933904127847565521038" +
			"97518527764158778759333880714882279633323826397312" +
			"37540692703944652530644783851437150365498785517230" +
			"63075841554598267070959096177525268004013269908287" +
			"21633726770440915439092677906646798573524199116648" +
			"26420692045116013363507136177381212171652817814824" +
			"07207832267365496237361352749903091381431832483719" +
			"59875978805027500928693808073336955752759088442865" +
			"60007519988899832388064354967005550542136243510857" +
			"27320873229820271877724592312289894723729518643210" +
			"99261878781084330252988333921362998963303722431059" +
			"74196876345240695383501512053377338528990471084362" +
			"84027002747028704740738252488288899849942846076048" +
			"47211794221210729913159829014217168004461049532662" +
			"69654291318362815719956164194992393662936899285662" +
			"13830845453276369722655423553417498556630200048873" +
			"16835216156767223053799811067258913808469994232607" +
			"85885452406443214577592214453570123646898570521297" +
			"70454794895156900093889236255806857887076058773438" +
			"57669170894656797423368490329407251160393356048820" +
			"60708508906902541358426981673974721123951355041438" +
			"31175088267631435128620064970580411452960978929179" +
			"99935577053234252698691933792724753682184537682835" +
			"56282993863000483838436394424313762286491825747425" +
			"62801272911169650506001781204777207847421842053761" +
			"95975831677721764740044536624645764471381571452381" +
			"83012539876515208328748311027939469785591571398193" +
			"99706845991995948630072306240767861396175546314507" +
			"34995190081932187616814234632738778224433256463738" +
			"34643527490571092558110606127384097559293176126679" +
			"92655877654689467643370851923693583162984574500088" +
			"09428586921504743730873895710474614480003727146162" +
			"34985833329151655216254537031220039084158830948097" +
			"32746316462735973902494777466571318911964823986701" +
			"18797910098918899689482196956660638225731960693542" +
			"76396430230899969295709106130018364832978518279330" +
			"14072672000463830430052367599773876014077691103832" +
			"95729918654520937785586390633157020347632812108728" +
			"63858981328256952957676936717332476408528570530831" +
			"29549574015582471687399314465694228187234824710973" +
			"74362105279278558570746278168331596903799527959001" +
			"67485615556461982140704479972002062064223324605784" +
			"82364760475407628497883254356305924201944904435394" +
			"28990899488655890183886788650518595542180257939200" +
			"53964504180838776023818956242835177463244062261805" +
			"69131374998200219247331736680368064857334435670396" +
			"13866037176155955253827548473360440517049422696075" +
			"50118329257306325061302116750385856108223837443919" +
			"34132314726080728887333265128532878067733890732992" +
			"97372760244397355791502004654458118728037510329034" +
			"12064303018234671601197499671959893427763529776295" +
			"88372473893669097633674936822994303626689961939354" +
			"05226221180280462691353912282455701759810037116439" +
			"96888363959610892641352882620050251155107166154107" +
			"12418923190708129942695180863852959923810259571729" +
			"92399312141414210235547707008555590049509294048331" +
			"17825888564525429573783492759033277310584382679775" +
			"65400398102950216990377882282050721467380943202619" +
			"80823252096852875670591366194556595549470362090317" +
			"23334912816047562629324653843003922646387725351785" +
			"50629818900587124158665787276943628778050785941159" +
			"39049922697215689139042884475829798201399221843339" +
			"84314433432975097626505437589863708761940677635786" +
			"23415995395857721733625699297232173138562186107390" +
			"79911693928395573354107695207924389443047735986097" +
			"05711710276164739858374670406622219248962849157924" +
			"18615122284579427276776562170680603040634318594449" +
			"99092873095546808035894071193872676924207893595051" +
			"33406787086697858524106329839944880166497950357625" +
			"87308531377626567159326745848784087650743487153508" +
			"08211160488037567370082449596914044378631384351574" +
			"51457440726626860151841812114063901777295075543982" +
			"23521426054656397563309371854348127764374551700527" +
			"04254873689525989445652781559474644227537684964321" +
			"62594620064734772610046887544579759229119236372464" +
			"11006025717239601043897275614876162138938801586992" +
			"61565353860394268412519478250755882121502350855777" +
			"54898735495718761136464434778346062391856979035771" +
			"20787080300717298621472041190620031457830576579643" +
			"35620490686654777775857772417230654005669380137272" +
			"18865010450285956328253564273453343056728731949830" +
			"45289158766383702966072096547272468101207491470115" +
			"79846007686876872348978767610197018167444101532656" +
			"50069958640767440432524938018706695622887762120628" +
			"11301410353399292598950872168099763560393041763246" +
			"15051223863642132987493989282096132023719628675179" +
			"65979309944112423418135458308263630611543033524825" +
			"66365955427530635779461773992943363184596117548311" +
			"89657065079679934928129113295189411660749306226747" +
			"06175331676048029076084642134755755360718525446251" +
			"49916347891632155925545652886250214290645942174440" +
			"34435094635489801294636044217141894128608560200837" +
			"94290110401471378303904658722883388803270951373270" +
			"01016670028338850101424076202334381068610870620559" +
			"06874872893491133678484259720820886397724438939944" +
			"32644994251669662868351003042623725776542626953259" +
			"52481832896116023739523050738270294258384810074433" +
			"61481172033664199893614932623554378101313353925699" +
			"16276758180944417495729353264103411236716394047249" +
			"64548266454966082684914359753307547920224734132546" +
			"41635309131365360013914909519963236046952897089347" +
			"01613673898413313379087410114316869102214191896779" +
			"78774764501005850673487661832249908142536107635929" +
			"74731784263832853675045343246533254966131311531411" +
			"06847871042978679181140465868080558810576851829209" +
			"81292591641511531266153414983793243539534507238740" +
			"92401152015787628879390603785057522375088322779364" +
			"00701843358254367309099083335229630229039016533664" +
			"73552423659829036706485637272392835472412020290219" +
			"01993493453231407543942533374303128855544718854681" +
			"13381870371730961599956361702606936020815639321492" +
			"43338560377267712598579312984879090067829871959268" +
			"35910537279213582905667384935745871483880724959685" +
			"37728445545132500938935911535634185974754830207571" +
			"56144398767123041139956792509074548838953023966323" +
			"81653230532032695481751231940062856024456656381220" +
			"71341343132544448375753426244933967514721424307914" +
			"45986588082025489263121205966978633565547223481141" +
			"94969409174072455372221354826189882023922524876054" +
			"93590592945425892550538789803952832907668955110893" +
			"23428562436979996379382280686655953458559782154202" +
			"74558562368590236467711884770512666328306756286559" +
			"34857463627291641433234999222527737907195209523444" +
			"30418200548549703239314040776103237309889148891883" +
			"56127533914074856107086479831584739755622106834971" +
			"36899733424643226401275726162895421362617779712728" +
			"98183575589265919111753761345547373676729412244169" +
			"66599144520688033032388494464597481600684233179969" +
			"68871337715396910701482058650018789002841975996662" +
			"91258969038597244820185515673684593394372820274731" +
			"63713630554370146518281068049701849575089743432349" +
			"30884928145618274502701184565362629078073829918130" +
			"57724820012509917610475433447904546259431560850446" +
			"61103576512523366161351099640751135385148305913987" +
			"88900869800923437094189134609830643793766122717238" +
			"65069806369037435412852356057801672160089208286108" +
			"42066522096589500420940606405692664109905063234866" +
			"11707751630869417570912321947628323029020749755515" +
			"94671499793470202096735004966510235544750050539912" +
			"95374430728524771212435107382664318842703197811901" +
			"07502703670304141931522915626327970886506400447339" +
			"24017108175330402101527579666914164718363614985462" +
			"49180866049039738294265863864925406135752428537159" +
			"88013206104282809077273310356143702107093883552048" +
			"49875647849023578266450061853848472997115130425589" +
			"13116550679842981785737713725790045128094411676264" +
			"85857320152907367807339638751926837379858254826386" +
			"85921196660973811892552471906413521954430814329459" +
			"81901223716745712543744847146503012460085216148335" +
			"80761962452839606901037087198164271275593296948450" +
			"11551844874545978463757825988097080968936454398564" +
			"78634508146859065978179351007580744928974114529788" +
			"21522648460182497414010735275877637899380000847946" +
			"36404597737881060392216475279156196383758972796539" +
			"46867057366337834721265500081035695372958187077367" +
			"63384842635134595953764413125539388694982804096611" +
			"27680137456714766222219731722990213227238306843450" +
			"54818157484501760113734299662298242039459694484074" +
			"67180888012626196399930140083357536658722023918044" +
			"38859486349114326724549095784795869760645981266331" +
			"77835011824812040440090529736915436564330317784343" +
			"26094141919900799456555633619565499476776839164184" +
			"31672912425878824000912081243486699963430700610267" +
			"32554587428779976439512259161737036335847682346728" +
			"53954977849338887052810296982292397645402247732207" +
			"52049054203778238008765407245607822425400433584943" +
			"05758648390071388556142954991440895026034342297754" +
			"62438747273269742326021101473172919613917251405395" +
			"25914282478873832433447553891044960379753606772247" +
			"65591211970382212225942797592005272680787386239303" +
			"94668942329370914896599940079590507375669702596756" +
			"43966610274896063378721528541518875744009791508702" +
			"95978066773059913103141338094206140446153595784659" +
			"69611699945126562704916274528149283184603386570790" +
			"83049449757325746370901021307528602414961598977205" +
			"66523711477673910492376257245019657271734451417565" +
			"93203484634107009301826277750779002612230277568017" +
			"90257236852308834599246314626021755359780018362732" +
			"35741164283034661871238537285831967107455175175353" +
			"58390707392142847337569520517907785592517088192226" +
			"24804375884738892604238619410922374901606937212732" +
			"40620386764335194931088348976798759367432835782278" +
			"31515029271833004625318824853722160041051755203800" +
			"11017474788028906062599491204428761237835908855606" +
			"56252460186357905009140761914399185986677439372975" +
			"59655094970714020006618496348625967305473951238868" +
			"75782636441382145663125435453597270764337830374274" +
			"65041953669256836694742522737866909258810743739579" +
			"50536867961073627490165000240704238728519647790865" +
			"82045166346561971622339566877672226418816295873094" +
			"91614672325114114391046549220647203371424629861598" +
			"28838334648766456731933873743225363023672070688260" +
			"60198721670883870486731458615363090131349551311164" +
			"22287017136792407563759184067574858025506213902259" +
			"30614926168099275260457933657233665059918500810800" +
			"76078345252003916680026723603176735311981150759594" +
			"90847422140317743301952951848731415516802657918957" +
			"58268696250195805872728809394511284458939711712334" +
			"16351919888199706464118260700198467216414695910921" +
			"64024401395343489147965070583811601105674236655404" +
			"25003738328954912183246033347861541003531213135973" +
			"45196743578362465084391591890717383427522967952200" +
			"11741499985820711455139187459135578520959861670610" +
			"22492545574120705909462524344111990614935124109843" +
			"46297239238119679218216929431383849185152962764253" +
			"48033629690654992991014825953506762715269921059653" +
			"63581364886771627097103730326454063985576045514371" +
			"60704207508866481964709272392954477248411151647112" +
			"64275166740133204311282436471630561749140744872435" +
			"75463379929857410388649441301822662353515625"},

		{exact128(0x1p-24), 'f', -1, "0.000000059604644775390625"},
		{exact128(0x2p-24), 'f', -1, "0.00000011920928955078125"},
		{exact128(0x3p-24), 'f', -1, "0.000000178813934326171875"},
		{exact128(0x4p-24), 'f', -1, "0.0000002384185791015625"},
		{exact128(0x5p-24), 'f', -1, "0.000000298023223876953125"},
		{exact128(0x6p-24), 'f', -1, "0.00000035762786865234375"},
		{exact128(0x7p-24), 'f', -1, "0.000000417232513427734375"},
		{exact128(0x8p-24), 'f', -1, "0.000000476837158203125"},
		{exact128(0x9p-24), 'f', -1, "0.000000536441802978515625"},
		{exact128(0xap-24), 'f', -1, "0.00000059604644775390625"},
		{Float128{0, 1}, 'f', -1, "0." +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"0000000000000006"},

		/****** binary exponent formats ******/
		{exact128(0x0p+0), 'b', -1, "0p-16494"},
		{exact128(1), 'b', -1, "5192296858534827628530496329220096p-112"},
		{exact128(1.5), 'b', -1, "7788445287802241442795744493830144p-112"},

		/******* hexadecimal formats *******/
		{exact128(0), 'x', -1, "0x0p+00"},
		{exact128(math.Inf(1)), 'x', -1, "+Inf"},
		{exact128(math.Inf(-1)), 'x', -1, "-Inf"},
		{exact128(math.NaN()), 'x', -1, "NaN"},

		{exact128(0x0.0p0), 'x', 0, "0x0p+00"},
		{exact128(0x1.0p0), 'x', 0, "0x1p+00"},
		{exact128(0x1.7p0), 'x', 0, "0x1p+00"},
		{exact128(0x1.8p0), 'x', 0, "0x1p+01"},

		{exact128(0x0.0p0), 'x', 1, "0x0.0p+00"},
		{exact128(0x1.0p0), 'x', 1, "0x1.0p+00"},
		{exact128(0x1.fp0), 'x', 1, "0x1.fp+00"},
		{exact128(0x1.08p0), 'x', 1, "0x1.0p+00"},
		{exact128(0x1.18p0), 'x', 1, "0x1.2p+00"},

		{exact128(0x1p0), 'x', -1, "0x1p+00"},
		{exact128(0x1.8p0), 'x', -1, "0x1.8p+00"},
		{exact128(0x1.08p0), 'x', -1, "0x1.08p+00"},
		{exact128(0x1.00cp0), 'x', -1, "0x1.00cp+00"},
	}

	for _, tt := range tests {
		if got := tt.x.Text(tt.fmt, tt.prec); got != tt.s {
			t.Errorf("Float128(%x).Text(%q, %d) = %q, want %q", ints.Uint128(tt.x), tt.fmt, tt.prec, got, tt.s)
		}
	}
}
