package floats

import (
	"math"
	"testing"

	"github.com/shogo82148/ints"
)

func TestFloat128_Text(t *testing.T) {
	tests := []struct {
		x    Float128
		fmt  byte
		prec int
		s    string
	}{
		/****** decimal formats ******/
		{exact128(0x1p-24), 'f', 24, "0.000000059604644775390625"},
		{exact128(0x2p-24), 'f', 24, "0.000000119209289550781250"},
		{exact128(0x3p-24), 'f', 24, "0.000000178813934326171875"},
		{exact128(0x4p-24), 'f', 24, "0.000000238418579101562500"},
		{exact128(0x5p-24), 'f', 24, "0.000000298023223876953125"},
		{exact128(0x6p-24), 'f', 24, "0.000000357627868652343750"},
		{exact128(0x7p-24), 'f', 24, "0.000000417232513427734375"},
		{exact128(0x8p-24), 'f', 24, "0.000000476837158203125000"},
		{exact128(0x9p-24), 'f', 24, "0.000000536441802978515625"},
		{exact128(0xap-24), 'f', 24, "0.000000596046447753906250"},

		{Float128{0, 1}, 'f', 16495, "0." +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000032375875597190125554622194791138232" +
			"76249784669017340504844942194598519770062059685508" +
			"83574563832497012793907073842405983829360994319127" +
			"10233425550359863089915213963553756674672083673128" +
			"19235870119724263252776995195727778126085574034035" +
			"41101734412849123813641439455151417866878067401553" +
			"11932822963199131134959539539338316310328556057915" +
			"32328598034154166422617226534880263244723830482289" +
			"65687570170131590217501997443503762782435668403305" +
			"89397015778833566517337174685312047058426075688036" +
			"66569711421917525834491783583598401321476176752039" +
			"85717355193026889144685010776058433385552147530501" +
			"09407568139932147308502166696009676987494125921676" +
			"92757446422169965426483919224341062751152057061076" +
			"52297323273154238205508723936852216765619483074181" +
			"96052769717057382723931306989375320957256133838073" +
			"12946395184980707534803490003540251394324459987958" +
			"40093911100112619086152361548593828549771441060964" +
			"07982738165117693915685918231984764157652755343417" +
			"09798367687043373145262933998108452661682659942586" +
			"30497841381275551816623917661447381594002534227957" +
			"53041594932607700680306368857466952063923782760519" +
			"48759263882079389379666940357441139816661913198656" +
			"18770346351972326265322391925718575182749392758615" +
			"31537920777299133535479548088762634002006634954143" +
			"60816863385220457719546338953323399286762099558324" +
			"13210346022558006681753568088690606085826408907412" +
			"03603916133682748118680676374951545690715916241859" +
			"79937989402513750464346904036668477876379544221432" +
			"80003759994449916194032177483502775271068121755428" +
			"63660436614910135938862296156144947361864759321605" +
			"49630939390542165126494166960681499481651861215529" +
			"87098438172620347691750756026688669264495235542181" +
			"42013501373514352370369126244144449924971423038024" +
			"23605897110605364956579914507108584002230524766331" +
			"34827145659181407859978082097496196831468449642831" +
			"06915422726638184861327711776708749278315100024436" +
			"58417608078383611526899905533629456904234997116303" +
			"92942726203221607288796107226785061823449285260648" +
			"85227397447578450046944618127903428943538029386719" +
			"28834585447328398711684245164703625580196678024410" +
			"30354254453451270679213490836987360561975677520719" +
			"15587544133815717564310032485290205726480489464589" +
			"99967788526617126349345966896362376841092268841417" +
			"78141496931500241919218197212156881143245912873712" +
			"81400636455584825253000890602388603923710921026880" +
			"97987915838860882370022268312322882235690785726190" +
			"91506269938257604164374155513969734892795785699096" +
			"99853422995997974315036153120383930698087773157253" +
			"67497595040966093808407117316369389112216628231869" +
			"17321763745285546279055303063692048779646588063339" +
			"96327938827344733821685425961846791581492287250044" +
			"04714293460752371865436947855237307240001863573081" +
			"17492916664575827608127268515610019542079415474048" +
			"66373158231367986951247388733285659455982411993350" +
			"59398955049459449844741098478330319112865980346771" +
			"38198215115449984647854553065009182416489259139665" +
			"07036336000231915215026183799886938007038845551916" +
			"47864959327260468892793195316578510173816406054364" +
			"31929490664128476478838468358666238204264285265415" +
			"64774787007791235843699657232847114093617412355486" +
			"87181052639639279285373139084165798451899763979500" +
			"83742807778230991070352239986001031032111662302892" +
			"41182380237703814248941627178152962100972452217697" +
			"14495449744327945091943394325259297771090128969600" +
			"26982252090419388011909478121417588731622031130902" +
			"84565687499100109623665868340184032428667217835198" +
			"06933018588077977626913774236680220258524711348037" +
			"75059164628653162530651058375192928054111918721959" +
			"67066157363040364443666632564266439033866945366496" +
			"48686380122198677895751002327229059364018755164517" +
			"06032151509117335800598749835979946713881764888147" +
			"94186236946834548816837468411497151813344980969677" +
			"02613110590140231345676956141227850879905018558219" +
			"98444181979805446320676441310025125577553583077053" +
			"56209461595354064971347590431926479961905129785864" +
			"96199656070707105117773853504277795024754647024165" +
			"58912944282262714786891746379516638655292191339887" +
			"82700199051475108495188941141025360733690471601309" +
			"90411626048426437835295683097278297774735181045158" +
			"61667456408023781314662326921501961323193862675892" +
			"75314909450293562079332893638471814389025392970579" +
			"69524961348607844569521442237914899100699610921669" +
			"92157216716487548813252718794931854380970338817893" +
			"11707997697928860866812849648616086569281093053695" +
			"39955846964197786677053847603962194721523867993048" +
			"52855855138082369929187335203311109624481424578962" +
			"09307561142289713638388281085340301520317159297224" +
			"99546436547773404017947035596936338462103946797525" +
			"66703393543348929262053164919972440083248975178812" +
			"93654265688813283579663372924392043825371743576754" +
			"04105580244018783685041224798457022189315692175787" +
			"25728720363313430075920906057031950888647537771991" +
			"11760713027328198781654685927174063882187275850263" +
			"52127436844762994722826390779737322113768842482160" +
			"81297310032367386305023443772289879614559618186232" +
			"05503012858619800521948637807438081069469400793496" +
			"30782676930197134206259739125377941060751175427888" +
			"77449367747859380568232217389173031195928489517885" +
			"60393540150358649310736020595310015728915288289821" +
			"67810245343327388887928886208615327002834690068636" +
			"09432505225142978164126782136726671528364365974915" +
			"22644579383191851483036048273636234050603745735057" +
			"89923003843438436174489383805098509083722050766328" +
			"25034979320383720216262469009353347811443881060314" +
			"05650705176699646299475436084049881780196520881623" +
			"07525611931821066493746994641048066011859814337589" +
			"82989654972056211709067729154131815305771516762412" +
			"83182977713765317889730886996471681592298058774155" +
			"94828532539839967464064556647594705830374653113373" +
			"53087665838024014538042321067377877680359262723125" +
			"74958173945816077962772826443125107145322971087220" +
			"17217547317744900647318022108570947064304280100418" +
			"97145055200735689151952329361441694401635475686635" +
			"00508335014169425050712038101167190534305435310279" +
			"53437436446745566839242129860410443198862219469972" +
			"16322497125834831434175501521311862888271313476629" +
			"76240916448058011869761525369135147129192405037216" +
			"80740586016832099946807466311777189050656676962849" +
			"58138379090472208747864676632051705618358197023624" +
			"82274133227483041342457179876653773960112367066273" +
			"20817654565682680006957454759981618023476448544673" +
			"50806836949206656689543705057158434551107095948389" +
			"89387382250502925336743830916124954071268053817964" +
			"87365892131916426837522671623266627483065655765705" +
			"53423935521489339590570232934040279405288425914604" +
			"90646295820755765633076707491896621769767253619370" +
			"46200576007893814439695301892528761187544161389682" +
			"00350921679127183654549541667614815114519508266832" +
			"36776211829914518353242818636196417736206010145109" +
			"50996746726615703771971266687151564427772359427340" +
			"56690935185865480799978180851303468010407819660746" +
			"21669280188633856299289656492439545033914935979634" +
			"17955268639606791452833692467872935741940362479842" +
			"68864222772566250469467955767817092987377415103785" +
			"78072199383561520569978396254537274419476511983161" +
			"90826615266016347740875615970031428012228328190610" +
			"35670671566272224187876713122466983757360712153957" +
			"22993294041012744631560602983489316782773611740570" +
			"97484704587036227686110677413094941011961262438027" +
			"46795296472712946275269394901976416453834477555446" +
			"61714281218489998189691140343327976729279891077101" +
			"37279281184295118233855942385256333164153378143279" +
			"67428731813645820716617499611263868953597604761722" +
			"15209100274274851619657020388051618654944574445941" +
			"78063766957037428053543239915792369877811053417485" +
			"68449866712321613200637863081447710681308889856364" +
			"49091787794632959555876880672773686838364706122084" +
			"83299572260344016516194247232298740800342116589984" +
			"84435668857698455350741029325009394501420987998331" +
			"45629484519298622410092757836842296697186410137365" +
			"81856815277185073259140534024850924787544871716174" +
			"65442464072809137251350592282681314539036914959065" +
			"28862410006254958805237716723952273129715780425223" +
			"30551788256261683080675549820375567692574152956993" +
			"94450434900461718547094567304915321896883061358619" +
			"32534903184518717706426178028900836080044604143054" +
			"21033261048294750210470303202846332054952531617433" +
			"05853875815434708785456160973814161514510374877757" +
			"97335749896735101048367502483255117772375025269956" +
			"47687215364262385606217553691332159421351598905950" +
			"53751351835152070965761457813163985443253200223669" +
			"62008554087665201050763789833457082359181807492731" +
			"24590433024519869147132931932462703067876214268579" +
			"94006603052141404538636655178071851053546941776024" +
			"24937823924511789133225030926924236498557565212794" +
			"56558275339921490892868856862895022564047205838132" +
			"42928660076453683903669819375963418689929127413193" +
			"42960598330486905946276235953206760977215407164729" +
			"90950611858372856271872423573251506230042608074167" +
			"90380981226419803450518543599082135637796648474225" +
			"05775922437272989231878912994048540484468227199282" +
			"39317254073429532989089675503790372464487057264894" +
			"10761324230091248707005367637938818949690000423973" +
			"18202298868940530196108237639578098191879486398269" +
			"73433528683168917360632750040517847686479093538683" +
			"81692421317567297976882206562769694347491402048305" +
			"63840068728357383111109865861495106613619153421725" +
			"27409078742250880056867149831149121019729847242037" +
			"33590444006313098199965070041678768329361011959022" +
			"19429743174557163362274547892397934880322990633165" +
			"88917505912406020220045264868457718282165158892171" +
			"63047070959950399728277816809782749738388419582092" +
			"15836456212939412000456040621743349981715350305133" +
			"66277293714389988219756129580868518167923841173364" +
			"26977488924669443526405148491146198822701123866103" +
			"76024527101889119004382703622803911212700216792471" +
			"52879324195035694278071477495720447513017171148877" +
			"31219373636634871163010550736586459806958625702697" +
			"62957141239436916216723776945522480189876803386123" +
			"82795605985191106112971398796002636340393693119651" +
			"97334471164685457448299970039795253687834851298378" +
			"21983305137448031689360764270759437872004895754351" +
			"47989033386529956551570669047103070223076797892329" +
			"84805849972563281352458137264074641592301693285395" +
			"41524724878662873185450510653764301207480799488602" +
			"83261855738836955246188128622509828635867225708782" +
			"96601742317053504650913138875389501306115138784008" +
			"95128618426154417299623157313010877679890009181366" +
			"17870582141517330935619268642915983553727587587676" +
			"79195353696071423668784760258953892796258544096113" +
			"12402187942369446302119309705461187450803468606366" +
			"20310193382167597465544174488399379683716417891139" +
			"15757514635916502312659412426861080020525877601900" +
			"05508737394014453031299745602214380618917954427803" +
			"28126230093178952504570380957199592993338719686487" +
			"79827547485357010003309248174312983652736975619434" +
			"37891318220691072831562717726798635382168915187137" +
			"32520976834628418347371261368933454629405371869789" +
			"75268433980536813745082500120352119364259823895432" +
			"91022583173280985811169783438836113209408147936547" +
			"45807336162557057195523274610323601685712314930799" +
			"14419167324383228365966936871612681511836035344130" +
			"30099360835441935243365729307681545065674775655582" +
			"11143508568396203781879592033787429012753106951129" +
			"65307463084049637630228966828616832529959250405400" +
			"38039172626001958340013361801588367655990575379797" +
			"45423711070158871650976475924365707758401328959478" +
			"79134348125097902936364404697255642229469855856167" +
			"08175959944099853232059130350099233608207347955460" +
			"82012200697671744573982535291905800552837118327702" +
			"12501869164477456091623016673930770501765606567986" +
			"72598371789181232542195795945358691713761483976100" +
			"05870749992910355727569593729567789260479930835305" +
			"11246272787060352954731262172055995307467562054921" +
			"73148619619059839609108464715691924592576481382126" +
			"74016814845327496495507412976753381357634960529826" +
			"81790682443385813548551865163227031992788022757185" +
			"80352103754433240982354636196477238624205575823556" +
			"32137583370066602155641218235815280874570372436217" +
			"877316899649287051943247206509113311767578125"},

		{exact128(0x1p-24), 'f', -1, "0.000000059604644775390625"},
		{exact128(0x2p-24), 'f', -1, "0.00000011920928955078125"},
		{exact128(0x3p-24), 'f', -1, "0.000000178813934326171875"},
		{exact128(0x4p-24), 'f', -1, "0.0000002384185791015625"},
		{exact128(0x5p-24), 'f', -1, "0.000000298023223876953125"},
		{exact128(0x6p-24), 'f', -1, "0.00000035762786865234375"},
		{exact128(0x7p-24), 'f', -1, "0.000000417232513427734375"},
		{exact128(0x8p-24), 'f', -1, "0.000000476837158203125"},
		{exact128(0x9p-24), 'f', -1, "0.000000536441802978515625"},
		{exact128(0xap-24), 'f', -1, "0.00000059604644775390625"},
		{Float128{0, 1}, 'f', -1, "0." +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"00000000000000000000000000000000000000000000000000" +
			"0000000000000003"},

		/****** binary exponent formats ******/
		{exact128(0x0p+0), 'b', -1, "0p-16494"},
		{exact128(1), 'b', -1, "5192296858534827628530496329220096p-112"},
		{exact128(1.5), 'b', -1, "7788445287802241442795744493830144p-112"},

		/******* hexadecimal formats *******/
		{exact128(0), 'x', -1, "0x0p+00"},
		{exact128(math.Inf(1)), 'x', -1, "+Inf"},
		{exact128(math.Inf(-1)), 'x', -1, "-Inf"},
		{exact128(math.NaN()), 'x', -1, "NaN"},

		{exact128(0x0.0p0), 'x', 0, "0x0p+00"},
		{exact128(0x1.0p0), 'x', 0, "0x1p+00"},
		{exact128(0x1.7p0), 'x', 0, "0x1p+00"},
		{exact128(0x1.8p0), 'x', 0, "0x1p+01"},

		{exact128(0x0.0p0), 'x', 1, "0x0.0p+00"},
		{exact128(0x1.0p0), 'x', 1, "0x1.0p+00"},
		{exact128(0x1.fp0), 'x', 1, "0x1.fp+00"},
		{exact128(0x1.08p0), 'x', 1, "0x1.0p+00"},
		{exact128(0x1.18p0), 'x', 1, "0x1.2p+00"},

		{exact128(0x1p0), 'x', -1, "0x1p+00"},
		{exact128(0x1.8p0), 'x', -1, "0x1.8p+00"},
		{exact128(0x1.08p0), 'x', -1, "0x1.08p+00"},
		{exact128(0x1.00cp0), 'x', -1, "0x1.00cp+00"},
	}

	for _, tt := range tests {
		if got := tt.x.Text(tt.fmt, tt.prec); got != tt.s {
			t.Errorf("Float128(%x).Text(%q, %d) = %q, want %q", ints.Uint128(tt.x), tt.fmt, tt.prec, got, tt.s)
		}
	}
}
